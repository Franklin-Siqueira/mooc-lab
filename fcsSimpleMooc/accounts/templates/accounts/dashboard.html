<!-- 

Base html file for user's control panel applications

Extends ../core/templates/base.html

 -->
{% extends "base.html" %}
<!--  Load courses/templatetags/courses_tags.py -->
{% load courses_tags %}
<!-- block content -->
{% block content %}
<!-- Load enrollments variable from course_tags.py-->
{% load_my_courses user as enrollments %}
<!-- Render base HTML -->
<div class="pure-g-r content-ribbon">
    <div class="pure-u-1">
        <ul class="breadcrumb">
            {% block breadcrumb %}
            	<li><a href="{% url 'accounts:dashboard' %}">My Control Panel</a></li>
            {% endblock %}
        </ul>
    </div>
    <div class="pure-u-1-3">
        <div class="pure-menu pure-menu-open">
            <ul>
                <li class="pure-menu-heading">Welcome, {{ user }}!</li>
            </ul>
            <ul> 
            {% block menu_options %}
                <li class="pure-menu-heading">Courses</li>
                <!-- Loop with enrollments in load_my_courses from courses_tags.py -->
                
                {% for enrollment in enrollments %}
	                <li>
	                    <a href="{% url 'courses:announcements' enrollment.course.shortcut %}">
	                    <i class="fa fa-book"></i> {{ enrollment.course }}
	                    </a>
	                </li>
                {% empty %}
                	<li>No courses found!</li>
                {% endfor %}
	         </ul>
	         <ul>
                <li class="pure-menu-heading">Account Settings</li>
                <li><a href="{% url 'accounts:edit' %}"><i class="fa fa-cog"></i> Edit data</a>
                </li>
                <li><a href="{% url 'accounts:edit_password' %}"><i class="fa fa-lock"></i> Edit password</a>
                </li>
           	</ul>
            {% endblock %}
            
        </div>
    </div>
    <div class="pure-u-2-3">
        <div class="inner">
            {% block dashboard_content %}
	            <h2>My Courses</h2>
	            {% for enrollment in enrollments %}
			            <div class="well">
			                <h3>
			                {{ enrollment.course }}
			                ({{ enrollment.course.startDate|date:'d/m/Y'|default:'To be disclosed...' }})
			                </h3>
			                {{ enrollment.course.desc|linebreaks }}
			                <div class="pure-controls">
			                    <a href="{% url 'courses:announcements' enrollment.course.shortcut %}" class="pure-button pure-button-primary">View</a>
			                    <a href="{% url 'courses:undo_enrollment' enrollment.course.shortcut %}" class="pure-button button-error">Cancel</a>
			                </div>
			            </div>
	           	{% empty %}
			            <aside class="pure-u-1">
			                <p>No enrolled courses found!</p>
			            </aside>
	            {% endfor %}
            {% endblock %}
        </div>
    </div>
</div>
{% endblock %}